<h2><%=h image_tag("bmo.png", :size => "100x70") %> Vector: <%=h @vector.name %> (<%=h scoredate_month_to_text(@date)%>/<%=h @date.year%>)</h2>
<br>

<div class="row-fluid">
	<div class="span4">
    	<table class="table table-bordered">
            <thead>
            	<tr>
                	<th width="12%">80%</th>
                    <th>Objetivos</th>
                </tr>
            </thead>
            <tbody>
            	<tr>
<% if @financiera.size > 0 %>
                <td><%= link_to image_tag("financiera_btn.png"), showdashboard_path("perspective", "current", 1, @date.id), :style=>'color:#FFFFFF;'%></td> 
                    <td>
                    	<div class="row-fluid">
                        
                          <% i = 0%>
                          <% @financiera.each do |o|%>
                              <% if i%2 == 0 %>
                                  <div class="row-fluid">
                              <% end %>
                              <% i = i + 1%>
                              <div class="span6" align="center">
                                <%= link_to objectiveatdate_path(o.id,@date.id,6) do %>
                                  <%=h image_tag(objectiveStaticButton(o,@date), :size => "148x70")%>
                                <% end %>
                              </div><!--span4-->
                              <% if i%2 == 0 %>
                                  </div> <!--fin row--></br>
                                <div class="row-fluid">
                              <% end %>
                          <% end %>
                             
                      </div>
                    </td>
                </tr>
<% end %> 
<% if @clientes.size > 0 %>
                <tr>
                	<td><%= link_to image_tag("clientesy_btn.png"), showdashboard_path("perspective", "current", 2, @date.id), :style=>'color:#FFFFFF;'%></td>
                    <td>
                    	<div class="row-fluid">
                        	
                          <% i = 0%>
                          <% @clientes.each do |o|%>
                              <% if i%2 == 0 %>
                                  <div class="row-fluid">
                              <% end %>
                              <% i = i + 1%>
                              <div class="span4" align="center">
                                <%= link_to objectiveatdate_path(o.id,@date.id,6) do %>
                                  <%=h image_tag(objectiveStaticButton(o,@date), :size => "148x70")%>
                                <% end %>
                              </div><!--span4-->
                              <% if i%2 == 0 %>
                                  </div> <!--fin row--></br>
                                <div class="row-fluid">
                              <% end %>
                          <% end %>

                      </div>
                    </td>
                </tr>
<% end %> 
<% if @procesos.size > 0 %>
                <tr>
                	<td><%= link_to image_tag("procesos_btn.png"), showdashboard_path("perspective", "current", 3, @date.id), :style=>'color:#FFFFFF;'%></td>
                    <td>
                    	<div class="row-fluid">

                          <% i = 0%>
                          <% @procesos.each do |o|%>
                              <% if i%2 == 0 %>
                                  <div class="row-fluid">
                              <% end %>
                              <% i = i + 1%>
                              <div class="span6" align="center">                                
                                <%= link_to objectiveatdate_path(o.id,@date.id,6) do %>
                                  <%=h image_tag(objectiveStaticButton(o,@date), :size => "148x70")%>
                                <% end %>
                              </div><!--span4-->
                              <% if i%2 == 0 %>
                                  </div> <!--fin row--></br>
                                <div class="row-fluid">
                              <% end %>
                          <% end %>
                      </div>
                    </td>
                </tr>
<% end %>
<% if @desarrollo.size > 0 %>
                <tr>
                	<td><%= link_to image_tag("desarrollo_btn.png"), showdashboard_path("perspective", "current", 4, @date.id), :style=>'color:#FFFFFF;'%></td>
                    <td>
                    	<div class="row-fluid">

                          <% i = 0%>
                          <% @desarrollo.each do |o|%>
                              <% if i%3 == 0 %>
                                  <div class="row-fluid">
                              <% end %>
                              <% i = i + 1%>
                              <div class="span6" align="center">
                               <%= link_to objectiveatdate_path(o.id,@date.id,6) do %>
                                  <%=h image_tag(objectiveStaticButton(o,@date), :size => "148x70")%>
                                <% end %>
                              </div><!--span4-->
                              <% if i%3 == 0 %>
                                  </div> <!--fin row--></br>
                                <div class="row-fluid">
                              <% end %>
                          <% end %>

                        </div>
                    </td>
                </tr>
<% end %>
            </tbody>
        </table>
    </div>

<div class="span8">
  <table class="table table-bordered table-striped">        	
    <thead>
    	<tr>
        	<th width="5%">&nbsp;</th>
          <th width="5%">&nbsp;</th>
          <th width="35%">Indicadores por Objetivo</th>
          <th>Unidad</th>
          <th>Valor</th>
          <th>Meta</th>
          <th>Avance</th>
          <th>Base</th>
          <th>Comp</th>
       </tr>
    </thead>
    <tbody>
      <% if @financiera.size > 0 %>
      	<tr>
      	  <td rowspan="<%=h @financiera.size + 1%>"><%= link_to image_tag("financiera_btn.png"), showdashboard_path("perspective", "current", 4, @date.id), :style=>'color:#FFFFFF;'%></td>
          <% @financiera.each do |f|%>  
            <% a = ObjectiveScore.find_by_objective_id_and_scoredate_id(f.id,@date.id)%>
            <td colspan="2"><%= link_to objectiveatdate_path(f.id,@date.id,6) do %>
                  <%=h image_tag(objectiveStaticButton(f,@date), :size => "148x70")%></div>
                <% end %></td>
            <td>%</td>
            <td><%=h a.score%></td>
            <td><%=h a.goal%></td>
            <td><%=h a.progress%></td>
            <td><%=h a.baseline%></td>
            <td><%=h a.growth%></td>
            <% f.indicators.each do |i|%>  
              </tr><tr>
              <% ind = IndicatorScore.find_by_indicator_id_and_scoredate_id(i.id,@date.id)%>
              <td></td>
              <td><%= link_to ind.indicator.acronym, indicatoratdate_path(ind.indicator_id,ind.scoredate_id,6), :class => indicatorscorestate(ind), :style=>'color:#FFFFFF;'%></td>
              <td>%</td>
              <td><%=h ind.score%></td>
              <td><%=h ind.goal%></td>
              <td><%=h ind.progress%></td>
              <td><%=h ind.baseline%></td>
              <td><%=h ind.growth%></td>
            <% end %>
          <% end %>
        </tr>
      <% end %>
      <% if @clientes.size > 0 %>
        <tr>
        	<td rowspan="<%=h @clientes.size%>"><%= link_to image_tag("clientes_btn.png"), showdashboard_path("perspective", "current", 4, @date.id), :style=>'color:#FFFFFF;'%></a></td>
          <% @clientes.each do |c|%>  
            <% a = ObjectiveScore.find_by_objective_id_and_scoredate_id(c.id,@date.id)%>
            <td colspan="2"><%= link_to objectiveatdate_path(f.id,@date.id,6) do %>
                  <%=h objectiveOval(c,@date,c.acronym) %></div>
                <% end %></td>
            <td>%</td>
            <td><%=h a.score%></td>
            <td><%=h a.goal%></td>
            <td><%=h a.progress%></td>
            <td><%=h a.baseline%></td>
            <td><%=h a.growth%></td>
          <% end %>
        </tr>
      <% end %>
      <% if @procesos.size > 0 %>
        <tr><!--IniciaProceso-->
        	<td rowspan="<%=h @filasprocesos%>"><%= link_to image_tag("procesos_btn.png"), showdashboard_path("perspective", "current", 4, @date.id), :style=>'color:#FFFFFF;'%></td>
          <% @procesos.each do |p|%>  
              <% a = ObjectiveScore.find_by_objective_id_and_scoredate_id(p.id,@date.id)%>
              <td colspan="2"><%= link_to objectiveatdate_path(p.id,@date.id,6) do %>
                  <%=h image_tag(objectiveStaticButton(p,@date), :size => "148x70")%></div>
                <% end %></td>
              <td>%</td>
              <td><%=h a.score %></td>
              <td><%=h a.goal %></td>
              <td><%=h a.progress%></td>
              <td><%=h a.baseline%></td>
              <td><%=h a.growth%></td>
              <% p.indicators.each do |i|%>  
                </tr><!--dentro del each--><tr>
                <% ind = IndicatorScore.find_by_indicator_id_and_scoredate_id(i.id,@date.id)%>
                  <td></td>
                  <td><%= link_to ind.indicator.acronym, indicatoratdate_path(ind.indicator_id,ind.scoredate_id,6), :class => indicatorscorestate(ind), :style=>'color:#FFFFFF;'%></td>
                  <td>%</td>
                  <td><%=h ind.score%></td>
                  <td><%=h ind.goal%></td>
                  <td><%=h ind.progress%></td>
                  <td><%=h ind.baseline%></td>
                  <td><%=h ind.growth%></td>
                  <% if i.id == p.indicators.last.id%>
                    </tr><tr><!--if last-->
                  <% end %>    
              <% end %>
          <% end %>
        </tr><!--permanente al final-->
      <% end %>
      <% if @desarrollo.size > 0 %>
        <tr>
        	<td rowspan="2"><%= link_to image_tag("desarrollo_btn.png"), showdashboard_path("perspective", "current", 4, @date.id), :style=>'color:#FFFFFF;'%></td>
            <td><button class="btn btn-success" href="#">KPI 1</button></td>
            <td>%</td>
            <td>82</td>
            <td>80</td>
            <td>82</td>
            <td>72</td>
            <td>14%</td>
        </tr>
        <tr>
        	<td><button class="btn btn-warning" href="#">KPI 2</button></td>
            <td>%</td>
            <td>82</td>
            <td>80</td>
            <td>82</td>
            <td>72</td>
            <td>14%</td>
        </tr>      
      <% end %>
    </tbody>
    </table>
  </div>
</div>





<!--

-----------------------------------------------------------------







<h2>Vector: <%=h @vector.name %></h2>
</br>
<div class="row-fluid">
  <div class="span12">


  <% @perspectives.each do |p|%>
    <ul class="breadcrumb">
      <li>
        <h2><%=h p.name %></h2>
      </li>
    </ul>
      <% i = 0%>
        <% p.objectives.each do |o|%>
          <% if @objectives.include? o %>
            <% if i%3 == 0 %>
                <div class="row-fluid">
            <% end %>
            <% i = i + 1%>
            <div class="span4" align="center">
              <%= link_to o.name, objectiveatdate_path(o.id,@date.id,6), :class => state(o,@date)%>
            </div><!--span4-->
            <!--<% if i%3 == 0 %>
                </div> --><!--fin row--><!--</br>
              <div class="row-fluid">
            <% end %>
          <% end%>
        <% end %>
      </div></br>
  <% end %>

  </div>
</div>
-->
<div class="row-fluid" align="center">
    <%= link_to @date.year - 1, vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year - 1,12).id)%>
      <<
    <%= link_to "Enero", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,1).id)%>
    <%= link_to "Febrero", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,2).id)%>
    <%= link_to "Marzo", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,3).id)%>
    <%= link_to "Abril", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,4).id)%>
    <%= link_to "Mayo", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,5).id)%>
    <%= link_to "Junio", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,6).id)%>
    <%= link_to "Julio", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,7).id)%>
    <%= link_to "Agosto", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,8).id)%>
    <%= link_to "Septiembre", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,9).id)%>
    <%= link_to "Octubre", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,10).id)%>
    <%= link_to "Noviembre", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,11).id)%>
    <%= link_to "Diciembre", vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year,12).id)%>
      >>
    <%= link_to @date.year + 1, vectoratdate_path(@vector.id, ScoreDate.find_by_year_and_month(@date.year + 1,1).id)%>
</div>

